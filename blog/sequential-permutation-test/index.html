<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Estimation of False Discovery Rate using Sequential Permutation Pvalues</title>
  <meta name="author" content="Lisha Li">

  <link href="http://lisafly.github.io/atom.xml" type="application/atom+xml" rel="alternate"
        title="Lisha Li's Blog Atom Feed" />


  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="http://lisafly.github.io/favicon.png" rel="icon">
  <link href="http://lisafly.github.io/theme/css/main_2.css" media="screen, projection"
        rel="stylesheet" type="text/css">
  <script src="http://lisafly.github.io/theme/js/modernizr-2.0.js"></script>
  <script src="http://lisafly.github.io/theme/js/ender.js"></script>
  <script src="http://lisafly.github.io/theme/js/octopress.js" type="text/javascript"></script>

  <link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
      
    <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type= "text/javascript">
       MathJax.Hub.Config({
           config: ["MMLorHTML.js"],
           jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML"],
           TeX: { extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"], equationNumbers: { autoNumber: "AMS" } },
           extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js"],
           tex2jax: { 
               inlineMath: [ ['$','$'] ],
               displayMath: [ ['$$','$$'] ],
               processEscapes: true },
           "HTML-CSS": {
               styles: { ".MathJax .mo, .MathJax .mi": {color: "black ! important"}}
           }
       });
    </script>

</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="http://lisafly.github.io/">Lisha Li's Blog</a></h1>
    <h2>It's never too late to learn.</h2>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://lisafly.github.io/atom.xml" rel="subscribe-rss">RSS</a></li>
</ul>

<form action="http://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:http://lisafly.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>

<ul class="main-navigation">
    <li><a href="http://lisafly.github.io">Home</a></li>
    <li><a href="http://lisafly.github.io">Blog</a></li>
    <li><a href="http://lisafly.github.io/archives.html">Archives</a></li>
    <li><a href="http://lisafly.github.io/pages/about.html">About</a></li>
    <li><a href="http://lisafly.github.io/pages/resume.html">Resume</a></li>
</ul></nav>
  <div id="main">
    <div id="content">
<div>
  <article class="hentry" role="article">
<header>
      <h1 class="entry-title">Estimation of False Discovery Rate using Sequential Permutation Pvalues</h1>
      <p class="meta"><time datetime="2012-06-18T00:00:00" pubdate>Jun 18, 2012</time></p>
</header>

  <div class="entry-content"><p><img src="http://dclong.github.io/media/r/r.png" height="200" width="240" align="right"/>
I wrote a paper on sequential permutation test with Tim Bancroft and Dan Nettleton. 
The paper "T. Bancroft, C. Du and D. Nettleton (2012). 
Estimation of False Discovery Rate Using Sequential Permutation PÂ­Values." 
has been accepted by Biometrics. To illustrate ideas in the paper and make sequential 
permutation test easier to use, I wrote an R package <strong>dclong.spt</strong> which is availabe 
on <a href="https://github.com/dclong/dclong.spt">GitHub</a>. In order to make the package smaller, 
I moved these big datasets (used for illustrations in the paper) from the package to this website. </p>
<p>The data <a href="http://dclong.github.io/media/spt/marker.rda">barley</a> was produced by experiment 
"Genetic regulation of gene expression of barley in response
to stem rust (Pgt isolate TTKS)" and can be access from PLEXdb (BB64). 
There is a file called "BB64_RMA_tmt_medians.txt" on the download page contains RMA expressions. 
The rma expression for the 75 chips involve fungas infection is the dataset barley in this package. </p>
<p>The Band T-cell Acute Lymphocyctic Leukemia (ALL) data set can be 
access via the Bioconductor ALL package at <www.bioconductor.org>. 
Measures of messenger ribonucleic acid (mRNA) commonly referred to as expression levels
are available for 12,625 probesets in 128 ALL patients.
Of these 128 patients, we focus on the 21 males who have been classified as having a translocation
between chromosomes 9 and 22 (BCR/ABL) and the 5 males who have a translocation between
chromosomes 4 and 11 (ALL1/AF4). 
This subset of data is the <a href="http://dclong.github.io/media/spt/leukemia.rda">leukemia</a> used in the paper.</p>
<p>Biologists genetically mutated/changed the genotypes of barley. 
They could not change everywhere, so they changed 378 positions on the chromosome of barley. 
In the map, "A" and "B" are two types (sort of open and close). 
Because they know where the mutations are, they called them "markers"
(so that if a barley with a certain genotype has a higher expression level, then you may infer and
say, oh that may be caused by the 145th marker, etc.). 
The map has 7 chromosomes of barley, 1H, 2H, ..., 7H. 
These numbers are locations of markers on the chromosomes, like coordinates. 
There are some missing values in the original map, a naive method was used to interpolate the missing
values and produced this dataset <a href="http://dclong.github.io/media/spt/marker.rda">marker</a>. </p></div>
    <footer>
<p class="meta">
  <span class="byline author vcard">
    Posted by <span class="fn">Chuanlong (Ben) Du</span>
  </span>
<time datetime="2012-06-18T00:00:00" pubdate>Jun 18, 2012</time>  <span class="categories">
    <a class="category" href="http://lisafly.github.io/tag/research.html">research</a>
    <a class="category" href="http://lisafly.github.io/tag/sequential-permutation-test.html">sequential permutation test</a>
    <a class="category" href="http://lisafly.github.io/tag/biostatistics.html">biostatistics</a>
    <a class="category" href="http://lisafly.github.io/tag/acute-lymphocyctic-leukemia.html">Acute Lymphocyctic Leukemia</a>
    <a class="category" href="http://lisafly.github.io/tag/package.html">package</a>
    <a class="category" href="http://lisafly.github.io/tag/marker.html">marker</a>
    <a class="category" href="http://lisafly.github.io/tag/dclongspt.html">dclong.spt</a>
    <a class="category" href="http://lisafly.github.io/tag/r.html">R</a>
    <a class="category" href="http://lisafly.github.io/tag/barley.html">barley</a>
  </span>
</p>    </footer>
  </article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
  </section>
</div>
<aside class="sidebar">
  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="http://lisafly.github.io/blog/compress-and-decompress-in-linux/">Compress and Decompressing Archives in Linux</a>
      </li>
      <li class="post">
          <a href="http://lisafly.github.io/blog/useful-tools-linux/">Useful Tools in Linux</a>
      </li>
      <li class="post">
          <a href="http://lisafly.github.io/blog/macro-in-sas/">Macro in SAS</a>
      </li>
      <li class="post">
          <a href="http://lisafly.github.io/blog/general-tips-for-sas/">General Tips for SAS</a>
      </li>
      <li class="post">
          <a href="http://lisafly.github.io/blog/sas-data-manipulation/">Manipulate Data in SAS</a>
      </li>
    </ul>
  </section>
  <section>
      
    <h1>Categories</h1>
    <ul id="recent_posts">
        <li><a href="http://lisafly.github.io/category/fun-problem.html">fun problem</a></li>
        <li><a href="http://lisafly.github.io/category/fun-problems.html">Fun Problems</a></li>
        <li><a href="http://lisafly.github.io/category/linux.html">Linux</a></li>
        <li><a href="http://lisafly.github.io/category/programming.html">Programming</a></li>
        <li><a href="http://lisafly.github.io/category/research.html">Research</a></li>
        <li><a href="http://lisafly.github.io/category/software.html">Software</a></li>
        <li><a href="http://lisafly.github.io/category/statistics.html">Statistics</a></li>
        <li><a href="http://lisafly.github.io/category/windows.html">Windows</a></li>
        <li><a href="http://lisafly.github.io/category/work.html">Work</a></li>
    </ul>
  </section>
 

  <section>
  <h1>Tags</h1>
  <p class="tagcloud">
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/terminal.html">terminal</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/lock.html">lock</a>
          </span>
          <span class="tag-1">
              <a href="http://lisafly.github.io/tag/programming.html">programming</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/list.html">list</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/function.html">function</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/markov-chain.html">Markov chain</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/coin.html">coin</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/synchronization.html">synchronization</a>
          </span>
          <span class="tag-6">
              <a href="http://lisafly.github.io/tag/array.html">array</a>
          </span>
          <span class="tag-6">
              <a href="http://lisafly.github.io/tag/package.html">package</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/de.html">DE</a>
          </span>
          <span class="tag-6">
              <a href="http://lisafly.github.io/tag/python.html">Python</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/regex.html">regex</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/bug.html">bug</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/library.html">library</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/rng.html">RNG</a>
          </span>
          <span class="tag-4">
              <a href="http://lisafly.github.io/tag/matlab.html">MATLAB</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/ubuntu.html">Ubuntu</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/require.html">require</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/compile.html">compile</a>
          </span>
          <span class="tag-5">
              <a href="http://lisafly.github.io/tag/latex.html">Latex</a>
          </span>
          <span class="tag-5">
              <a href="http://lisafly.github.io/tag/probability.html">probability</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/martingale.html">martingale</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/stochastic.html">stochastic</a>
          </span>
          <span class="tag-6">
              <a href="http://lisafly.github.io/tag/ide.html">IDE</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/windows.html">Windows</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/plot.html">plot</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/vbvbnet.html">VB/VB.net</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/eclipse.html">Eclipse</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/formula.html">formula</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/chinese.html">Chinese</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/data-frame.html">data frame</a>
          </span>
          <span class="tag-6">
              <a href="http://lisafly.github.io/tag/research.html">research</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/backup.html">backup</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/server.html">server</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/permutation.html">permutation</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/rcpp.html">Rcpp</a>
          </span>
          <span class="tag-4">
              <a href="http://lisafly.github.io/tag/statistics.html">statistics</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/julia.html">Julia</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/verizon.html">verizon</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/compiler.html">compiler</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/email.html">email</a>
          </span>
          <span class="tag-2">
              <a href="http://lisafly.github.io/tag/r.html">R</a>
          </span>
          <span class="tag-5">
              <a href="http://lisafly.github.io/tag/cc.html">C/C++</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/phone.html">phone</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/override.html">override</a>
          </span>
          <span class="tag-5">
              <a href="http://lisafly.github.io/tag/mathematica.html">Mathematica</a>
          </span>
          <span class="tag-6">
              <a href="http://lisafly.github.io/tag/remote.html">remote</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/recursion.html">recursion</a>
          </span>
          <span class="tag-4">
              <a href="http://lisafly.github.io/tag/c.html">C++</a>
          </span>
          <span class="tag-6">
              <a href="http://lisafly.github.io/tag/hpc.html">HPC</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/work.html">Work</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/distribution.html">distribution</a>
          </span>
          <span class="tag-3">
              <a href="http://lisafly.github.io/tag/linux.html">Linux</a>
          </span>
          <span class="tag-6">
              <a href="http://lisafly.github.io/tag/graphics.html">graphics</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/skills.html">skills</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/number.html">number</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/vim.html">Vim</a>
          </span>
          <span class="tag-3">
              <a href="http://lisafly.github.io/tag/java.html">Java</a>
          </span>
          <span class="tag-6">
              <a href="http://lisafly.github.io/tag/io.html">IO</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/image.html">image</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/sequence.html">sequence</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/bash.html">bash</a>
          </span>
          <span class="tag-6">
              <a href="http://lisafly.github.io/tag/concurrency.html">concurrency</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/operator.html">operator</a>
          </span>
          <span class="tag-6">
              <a href="http://lisafly.github.io/tag/sas.html">SAS</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/network.html">network</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/jekyll.html">Jekyll</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/puzzle.html">puzzle</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/mutex.html">mutex</a>
          </span>
          <span class="tag-6">
              <a href="http://lisafly.github.io/tag/matrix.html">matrix</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/os.html">OS</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/debian.html">Debian</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/pdf.html">PDF</a>
          </span>
          <span class="tag-6">
              <a href="http://lisafly.github.io/tag/vector.html">vector</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/portable.html">portable</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/condition.html">condition</a>
          </span>
          <span class="tag-4">
              <a href="http://lisafly.github.io/tag/software.html">software</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/trick.html">trick</a>
          </span>
          <span class="tag-5">
              <a href="http://lisafly.github.io/tag/string.html">string</a>
          </span>
          <span class="tag-6">
              <a href="http://lisafly.github.io/tag/thread.html">thread</a>
          </span>
          <span class="tag-6">
              <a href="http://lisafly.github.io/tag/math.html">math</a>
          </span>
          <span class="tag-6">
              <a href="http://lisafly.github.io/tag/parallel.html">parallel</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/ssh.html">SSH</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/debug.html">debug</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/loop.html">loop</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/pattern.html">pattern</a>
          </span>
          <span class="tag-4">
              <a href="http://lisafly.github.io/tag/fun-problems.html">fun problems</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/configuration.html">configuration</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/anti-virus.html">anti-virus</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/office.html">office</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/d.html">D</a>
          </span>
          <span class="tag-5">
              <a href="http://lisafly.github.io/tag/tips.html">tips</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/shell.html">shell</a>
          </span>
          <span class="tag-7">
              <a href="http://lisafly.github.io/tag/dropbox.html">Dropbox</a>
          </span>
          <span class="tag-5">
              <a href="http://lisafly.github.io/tag/ruby.html">Ruby</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/web.html">Web</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/trap.html">trap</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/mt.html">MT</a>
          </span>
          <span class="tag-8">
              <a href="http://lisafly.github.io/tag/character.html">character</a>
          </span>
  </p>
  </section>



  <section>
    <h1>GitHub Repos</h1>
    <ul id="gh_repos">
      <li class="loading">Status updating...</li>
    </ul>
      <a href="https://github.com/dclong">@dclong</a> on GitHub
    <script type="text/javascript">
      $.domReady(function(){
          if (!window.jXHR){
              var jxhr = document.createElement('script');
              jxhr.type = 'text/javascript';
              jxhr.src = 'http://lisafly.github.io/theme/js/jXHR.js';
              var s = document.getElementsByTagName('script')[0];
              s.parentNode.insertBefore(jxhr, s);
          }

          github.showRepos({
              user: 'dclong',
              count: 3,
              skip_forks: true,
              target: '#gh_repos'
          });
      });
    </script>
    <script src="http://lisafly.github.io/theme/js/github.js" type="text/javascript"> </script>
  </section>

    <section>
        <h1>Social</h2>
        <ul>
            <li><a href="http://www.linkedin.com/pub/chuanlong-ben-du/21/9b2/123/" target="_blank">LinkedIn</a></li>
            <li><a href="https://twitter.com/longendu" target="_blank">Twitter</a></li>
            <li><a href="https://www.facebook.com/chuanlong.du" target="_blank">Facebook</a></li>
        <!--
            <li><a href="http://lisafly.github.io/" type="application/rss+xml" rel="alternate">RSS</a></li>
            -->
        </ul>
    </section>
</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Lisha Li -
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p></footer>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30259661-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
	<script type="text/javascript">
	  var disqus_shortname = 'dclong';
          var disqus_identifier = '/blog/sequential-permutation-test/';
          var disqus_url = 'http://lisafly.github.io/blog/sequential-permutation-test/';
          var disqus_title = 'Estimation of False Discovery Rate using Sequential Permutation Pvalues';
	  (function() {
	    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
	    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	   })();
	</script>
</body>
</html>